(this["webpackJsonptosuccess-activities"]=this["webpackJsonptosuccess-activities"]||[]).push([[0],{203:function(t,e,n){},204:function(t,e,n){},232:function(t,e,n){},233:function(t,e,n){},354:function(t,e,n){"use strict";n.r(e);var a=n(2),r=n(0),i=n(18),s=n.n(i),c=(n(203),n(204),n(11)),o=n(10),l=n(14),u=n(13),h=n(404),d=n(402),j=n(401),b=n(15),p=n.n(b),v=n(26),f=n(102),_=n(180),g=n(20),O=n(118),y=function(){function t(e,n){Object(c.a)(this,t),this.url_activities="https://vegsja.pythonanywhere.com/activities/",this.url_categories="https://vegsja.pythonanywhere.com/categories/",this.url_stats="https://vegsja.pythonanywhere.com/stats/",this.url_date="https://vegsja.pythonanywhere.com/date/",this.url_refresh="https://vegsja.pythonanywhere.com/refresh/",this.logoutUrl="https://vegsja.pythonanywhere.com/logout/",this.delete_url="https://vegsja.pythonanywhere.com/delete/",this.token=e,this.refreshToken=n,this.categories=void 0,this.stats=void 0,this.errorFromServer=!1,this.errorMessage=null,localStorage.setItem("current_token",this.token),localStorage.setItem("refresh_token",this.refreshToken)}return Object(o.a)(t,[{key:"handleError",value:function(t){throw this.errorMessage=t.request.statusText,this.errorFromServer=!0,this.sendRefreshToken(),this.errorMessage}},{key:"sendRefreshToken",value:function(){var t=Object(v.a)(p.a.mark((function t(){var e,n=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={refresh:this.refreshToken},t.next=3,O.post(this.url_refresh,e,{"Content-Type":"text/json"}).then((function(t){n.token=t.data.access,localStorage.setItem("current_token",n.token),n.errorFromServer=!1}));case 3:t.sent;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"get_current_date",value:function(){var t=Object(v.a)(p.a.mark((function t(){var e=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.get(this.url_date,{headers:{Authorization:"Bearer ".concat(this.token)}}).then((function(t){return e.date=t.data,e.date})).catch((function(t){e.handleError(t)}));case 2:t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"get_activities",value:function(){var t=Object(v.a)(p.a.mark((function t(e){var n,a=this,r=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:2,t.next=3,O.get(this.url_activities+"?date="+e.toString()+"&nb_days="+n.toString(),{headers:{Authorization:"Bearer ".concat(this.token)}}).then((function(t){return a.activities=t.data,console.log("Successfully retrieved activities: ",a.activities),a.activities})).catch((function(t){a.handleError(t)}));case 3:t.sent;case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"post_activity",value:function(){var t=Object(v.a)(p.a.mark((function t(e,n,a,r,i,s){var c,o=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c={activity_name:e,activity_category:n,minutes_after_midnight_start:a,minutes_after_midnight_end:r,date:i,date_string:s},t.next=3,O.post(this.url_activities,c,{"Content-Type":"text/json",headers:{Authorization:"Bearer ".concat(this.token)},timeout:3e4}).then((function(t){console.log("Successfully posted data:",c)})).catch((function(t){console.log("Failed to post activity: ",t.request.statusText),o.handleError(t)}));case 3:t.sent;case 4:case"end":return t.stop()}}),t,this)})));return function(e,n,a,r,i,s){return t.apply(this,arguments)}}()},{key:"delete_activity",value:function(){var t=Object(v.a)(p.a.mark((function t(e){var n=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.delete(this.url_activities+e+"/",{headers:{Authorization:"Bearer ".concat(this.token)}}).catch((function(t){n.handleError(t)}));case 2:t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"post_category",value:function(){var t=Object(v.a)(p.a.mark((function t(e,n){var a,r=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.sendRefreshToken(),a={name:e,color:n},t.next=4,O.post(this.url_categories,a,{"Content-Type":"text/json",headers:{Authorization:"Bearer ".concat(this.token)},timeout:3e4}).then((function(t){console.log("Successfully posted data: ",a)})).catch((function(t){r.handleError(t)})).finally((function(){console.log("Everything else failed")}));case 4:t.sent;case 5:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"get_categories",value:function(){var t=Object(v.a)(p.a.mark((function t(){var e=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.get(this.url_categories,{headers:{Authorization:"Bearer ".concat(this.token)}}).then((function(t){return e.categories=t.data,e.categories})).catch((function(t){e.handleError(t)}));case 2:t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"delete_category",value:function(){var t=Object(v.a)(p.a.mark((function t(e){var n=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.delete(this.url_categories+e+"/",{headers:{Authorization:"Bearer ".concat(this.token)}}).catch((function(t){n.handleError(t)}));case 2:t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"get_stats",value:function(){var t=Object(v.a)(p.a.mark((function t(e,n){var a=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.get(this.url_stats+"?start_date="+e+"&end_date="+n,{headers:{Authorization:"Bearer ".concat(this.token)}}).then((function(t){return a.stats=t.data,a.stats})).catch((function(t){a.handleError(t)}));case 2:t.sent;case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"post_logout",value:function(){var t=Object(v.a)(p.a.mark((function t(){var e,n=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={refresh_token:this.refreshToken,access_token:this.token},t.next=3,O.post(this.logoutUrl,e,{"Content-Type":"text/json",headers:{Authorization:"Bearer ".concat(this.token)}}).then((function(t){console.log("Successfully logged out of server: ",t.status)})).catch((function(t){n.handleError(t)}));case 3:t.sent;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}();n(118);function k(){return m.apply(this,arguments)}function m(){return(m=Object(v.a)(p.a.mark((function t(){var e,n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=localStorage.getItem("refresh_token").toString(),n=localStorage.getItem("current_token").toString(),(a=new y(n,e)).post_logout().catch((function(t){a.sendRefreshToken().then((function(){k()})).catch((function(){alert("Error on logout:",t)}))}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var x,C=function(){var t=Object(g.k)();return Object(a.jsx)("div",{children:Object(a.jsx)(f.GoogleLogout,{clientId:"767187782063-nm6b5i4a6uscq2d9sj8kcfv9taoeej5d.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(e){k().then((function(){t.push({pathname:"/landing"})}))},render:function(t){return Object(a.jsx)(_.a,{onClick:t.onClick,disabled:t.disabled,variant:"danger",size:"lg",children:"Log out"})}})})},w=n(49),S=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,t)}return Object(o.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(h.a,{bg:"dark",variant:"dark",children:[Object(a.jsx)(w.LinkContainer,{to:"/activities",children:Object(a.jsx)(h.a.Brand,{href:"#home",children:"ToSuccess"})}),Object(a.jsxs)(d.a,{className:"mr-auto",children:[Object(a.jsx)(w.LinkContainer,{to:"/activities",children:Object(a.jsx)(d.a.Link,{children:"Activities"})}),Object(a.jsx)(w.LinkContainer,{to:"/categories",children:Object(a.jsx)(d.a.Link,{children:"Categories"})}),Object(a.jsx)(w.LinkContainer,{to:"/stats",children:Object(a.jsx)(d.a.Link,{children:"Stats"})}),Object(a.jsx)(w.LinkContainer,{to:"/settings",children:Object(a.jsx)(d.a.Link,{children:"Settings"})})]}),Object(a.jsx)(j.a,{inline:!0,children:Object(a.jsx)(w.LinkContainer,{to:"/landing",children:Object(a.jsx)(C,{})})})]})}}]),n}(r.Component),T=n(50),D=n(390),L=(n(232),r.Component,n(118)),I="https://vegsja.pythonanywhere.com/google/";function H(){return(H=Object(v.a)(p.a.mark((function t(e){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={token:e},t.next=3,L.post(I,n,{"Content-Type":"text/json"}).then((function(t){return t.data}));case 3:return a=t.sent,x=a,t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var N=function(){var t=Object(g.k)();return Object(a.jsx)("div",{children:Object(a.jsx)(f.GoogleLogin,{clientId:"767187782063-nm6b5i4a6uscq2d9sj8kcfv9taoeej5d.apps.googleusercontent.com",render:function(t){return Object(a.jsx)(_.a,{onClick:t.onClick,disabled:t.disabled,variant:"primary",size:"lg",children:"Start planning!"})},buttonText:"Login",onSuccess:function(e){(function(t){return H.apply(this,arguments)})(e.tokenId).then((function(n){t.push({pathname:"/activities",state:{userid:e.profileObj.userid,name:e.profileObj.givenName,backend_access_token:x.access_token,backend_refresh_token:x.refreash_token}})}))},onFailure:function(t){console.log("[Login failed] res:",t)},cookiePolicy:"single_host_origin"})})};n.p,n(88),n(233);function A(){return console.log("Langing page"),Object(a.jsx)("div",{className:"page-contain",class:"backgroundDiv",children:Object(a.jsxs)("div",{className:"content-left",children:[Object(a.jsx)("h1",{class:"landingPage",children:"Achieve it!"}),Object(a.jsx)("p",{children:" The daily planner which structures your day in a revolutinary way"}),Object(a.jsx)(w.LinkContainer,{to:"/activities",children:Object(a.jsx)(N,{})})]})})}var M=n(54),E=n(108),F=function(t){var e={maintainAspectRatio:!1,responsive:!1,labels:t.labels,datasets:[{data:t.data,backgroundColor:t.colors}]};return Object(a.jsx)("div",{style:{width:"50%",float:"right"},children:Object(a.jsx)(E.Doughnut,{data:e,options:{legend:{display:!1,position:"left"},elements:{arc:{borderWidth:0}}}})})},R=function(t){var e={labels:t.x_axis,datasets:t.dataset};return Object(a.jsx)("div",{style:{width:"50%",display:"left"},children:Object(a.jsx)(E.Line,{data:e})})},q=n(399),B=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={label:a.props.label,defaultValue:a.props.value,onChange:a.props.onChange},a}return Object(o.a)(n,[{key:"render",value:function(){return Object(a.jsx)("form",{noValidate:!0,children:Object(a.jsx)(q.a,{id:"date",label:this.state.label,type:"date",defaultValue:this.state.defaultValue,InputLabelProps:{shrink:!0},onChange:this.state.onChange})})}}]),n}(r.Component),z=n(394),G=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{children:Object(a.jsx)(z.a,{animation:"grow",className:"loading-table"})})}}]),n}(r.Component),P=function(){function t(e){Object(c.a)(this,t),this.serverData=e,this.data_obj=this.parseToDataObj(),this.label_list=this.parseToLabelList(),this.total_time_list=this.parseToTotalTime(),this.color_list=this.parseToColorList(),this.date_list=this.parseToDateList(),this.data_set=this.parseToDataSet(),console.log(this.data_set)}return Object(o.a)(t,[{key:"parseToDataObj",value:function(){return JSON.parse(this.serverData[0].data)}},{key:"parseToLabelList",value:function(){var t=[];for(var e in this.data_obj)t.push(e);return t}},{key:"parseToTotalTime",value:function(){var t=[];for(var e in this.data_obj)t.push(this.data_obj[e].total_time);return t}},{key:"parseToColorList",value:function(){var t=[];for(var e in this.data_obj)t.push(this.data_obj[e].color);return t}},{key:"parseToDateList",value:function(){var t=[];for(var e in this.data_obj[this.label_list[0]].date_data)t.push(e);return t}},{key:"parseToDataSet",value:function(){var t=[];for(var e in this.data_obj){var n=[],a={};for(var r in a.label=e,this.data_obj[e].date_data)n.push(this.data_obj[e].date_data[r]);a.data=n,a.fill=!1,a.borderColor=this.data_obj[e].color,t.push(a)}return t}}]),t}();function J(){var t=Object(r.useState)({loading:!0,start_date:null,end_date:null,statsHandler:null}),e=Object(M.a)(t,2),n=e[0],i=e[1],s=localStorage.getItem("routeState");s&&(s=JSON.parse(s));var c=s.backend_access_token,o=s.backend_refresh_token,l=new y(c,o),u=0,h=function t(e,n){l.get_stats(e,n).then((function(t){i({loading:!1,start_date:e,end_date:n,statsHandler:new P(l.stats)})})).catch((function(e){console.log("Caught error:",e),l.sendRefreshToken().then((function(){(u+=1)<2&&t()}))}))},d=n.loading,j=(n.start_date,n.end_date,n.statsHandler);return!0===d&&function t(){l.get_current_date().then((function(t){var e=l.date.daynumber,n=(l.date.daynumber-7)%365;h(n,e)})).catch((function(){t()}))}(),!0===d?Object(a.jsx)("div",{children:Object(a.jsx)(G,{})}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Stats"}),Object(a.jsx)(F,{labels:j.label_list,data:j.total_time_list,colors:j.color_list}),Object(a.jsx)(R,{x_axis:j.date_list,dataset:j.data_set})]})}function Y(){return Object(a.jsx)("h1",{children:"Settings"})}var U=n(38),V=(n(311),n(403)),X=n(185),W=n.n(X),K=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).style={margin:0,top:"auto",right:20,bottom:20,left:"auto",position:"fixed",outline:"none"},a}return Object(o.a)(n,[{key:"render",value:function(){return Object(a.jsx)(V.a,{color:"primary","aria-label":"add",style:this.style,onClick:this.props.handleClick,children:Object(a.jsx)(W.a,{})})}}]),n}(r.Component),Q=n(191),Z=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={color:a.props.defaultColor},a}return Object(o.a)(n,[{key:"render",value:function(){return Object(a.jsx)(Q.a,{color:this.state.defaultColor,onChange:this.props.onChange})}}]),n}(r.Component),$=n(395),tt=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).circleStyle={"margin-right":"1vh",display:"inline-block",position:"relative",backgroundColor:a.props.color,borderRadius:10,width:5,height:30},a}return Object(o.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{style:this.circleStyle})}}]),n}(r.Component),et=n.p+"static/media/delete.bed8c76b.svg",nt=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var t={margin:"auto",position:this.props.position,backgroundColor:"white",borderColor:"white",color:"black",right:"1%",top:"5%"};return Object(a.jsx)("div",{children:Object(a.jsx)(_.a,{type:"Danger",style:t,onClick:this.props.onClick,children:Object(a.jsx)("img",{src:et,height:"20vh",width:"20vh"})})})}}]),n}(r.Component),at=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={color:a.props.color,name:a.props.name,unique_id:a.props.unique_id},a.api=a.props.api,a}return Object(o.a)(n,[{key:"onDelete",value:function(){var t=this;this.api.delete_category(this.state.unique_id).then((function(){window.location.reload()})).catch((function(){t.api.sendRefreshToken().then((function(){t.onDelete()}))}))}},{key:"render",value:function(){var t=this;return Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:Object(a.jsx)(tt,{color:this.state.color,size:"5vh"})}),Object(a.jsx)("th",{children:Object(a.jsx)("h3",{children:this.state.name})}),Object(a.jsx)("th",{children:Object(a.jsx)(nt,{onClick:function(){return t.onDelete()},position:"relative"})})]})}}]),n}(r.Component);function rt(t,e){return t.sort((function(t,n){var a=t[e],r=n[e];if(!(Math.abs(parseInt(a)-parseInt(r))>10&&"date"==e))return a<r?-1:a>r?1:0}))}n(98);var it=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={loading:!0,backend_access_token:a.props.backendAccessToken,api_connection:a.props.api_connection,server_error:!1,server_error_message:null,categories:rt(a.props.categories,"name")},a}return Object(o.a)(n,[{key:"render_categories",value:function(){var t=[];for(var e in this.state.categories){var n=this.state.categories[e];t.push(Object(a.jsx)(at,{color:n.color,name:n.name,unique_id:n.unique_id,api:this.state.api_connection}))}return t}},{key:"render",value:function(){return Object(a.jsxs)($.a,{hover:!0,className:"category",children:[Object(a.jsx)("thead",{}),Object(a.jsx)("tbody",{children:this.render_categories()})]})}}]),n}(r.Component),st=n(396),ct=n(400),ot=n(181),lt=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;Object(c.a)(this,n),(a=e.call(this,t)).submitHandler=function(t){a.API.post_category(a.state.category_name,a.state.category_color).then((function(t){console.log("Success:",t),a.setState({loading:!0}),a.handleModalShowHide(),a.sendGetRequest()})).catch((function(){a.API.sendRefreshToken().then((function(){a.submitHandler()})).catch((function(){}))})),t.preventDefault()},a.state={showHide:!1,category_name:null,category_color:"#FFFFFFF",backend_access_token:null,backend_refresh_token:null,error_on_server:!1,error_message_from_server:null,categories:null,loading:!0};var r=localStorage.getItem("routeState");return r&&(r=JSON.parse(r)),a.state.backend_access_token=r.backend_access_token,a.state.backend_refresh_token=r.backend_refresh_token,a.API=new y(a.state.backend_access_token,a.state.backend_refresh_token),a.submitHandler=a.submitHandler.bind(Object(U.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.sendGetRequest()}},{key:"sendGetRequest",value:function(){var t=this;this.API.get_categories().then((function(e){t.state.categories=t.API.categories,t.setState({loading:!1})})).catch((function(e){t.API.sendRefreshToken().then((function(e){t.sendGetRequest()})).catch((function(e){t.handleServerError(e.request.statusText)}))}))}},{key:"handleServerError",value:function(t){this.setState({error_on_server:!0,error_message_from_server:t})}},{key:"handleModalShowHide",value:function(){this.API.sendRefreshToken(),this.setState({showHide:!this.state.showHide})}},{key:"onColorSelect",value:function(t,e){this.setState({category_color:t.hex})}},{key:"render",value:function(){var t=this;return this.state.loading?this.state.error_on_server?"Unauthorized"===this.state.error_message_from_server?Object(a.jsx)("div",{children:Object(a.jsx)(g.c,{to:"/landing"})}):Object(a.jsxs)(st.a,{variant:"danger",children:["Server error: ",this.state.error_message]}):Object(a.jsx)(G,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Categories"}),Object(a.jsx)(it,{backendAccessToken:this.state.backend_access_token,api_connection:this.API,categories:this.state.categories}),Object(a.jsx)(K,{handleClick:function(){return t.handleModalShowHide()}}),Object(a.jsxs)(ct.a,{show:this.state.showHide,centered:!0,children:[Object(a.jsx)(ct.a.Header,{closeButton:!0,onClick:function(){return t.handleModalShowHide()},children:Object(a.jsx)(ct.a.Title,{children:"Add category"})}),Object(a.jsxs)(j.a,{children:[Object(a.jsxs)(ct.a.Body,{children:[Object(a.jsxs)(ot.a,{controlId:"formCategoryName",children:[Object(a.jsx)(j.a.Label,{children:"Category name:"}),Object(a.jsx)(j.a.Control,{type:"string",placeholder:"Enter category name...",onChange:function(e){return t.setState({category_name:e.target.value})}})]}),Object(a.jsxs)(ot.a,{controlId:"formColor",children:[Object(a.jsx)(j.a.Label,{children:"Category Color:"}),Object(a.jsx)(Z,{color:"#FFFFFF",onChange:function(e,n){return t.onColorSelect(e,n)}})]})]}),Object(a.jsxs)(ct.a.Footer,{children:[Object(a.jsx)(_.a,{variant:"secondary",onClick:function(){return t.handleModalShowHide()},children:"Close"}),Object(a.jsx)(_.a,{variant:"primary",type:"submit",onClick:this.submitHandler,children:"Add Category"})]})]})]})]})}}]),n}(r.Component);function ut(){return Object(a.jsx)("div",{children:Object(a.jsx)(lt,{})})}var ht=n(190),dt=n(406),jt=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={category:a.props.category,color:a.props.color,position_style:a.props.position_style},a}return Object(o.a)(n,[{key:"render",value:function(){var t={width:"fit-content",padding:"1",borderRadius:"12px",backgroundColor:this.state.color,position:this.state.position_style};return Object(a.jsx)("div",{style:t,children:Object(a.jsx)("p",{style:{margin:"5px",color:"white","font-size":"1vw"},children:this.state.category})})}}]),n}(r.Component),bt=function(){function t(){Object(c.a)(this,t)}return Object(o.a)(t,[{key:"timeConvert",value:function(t){var e=t/60,n=Math.floor(e),a=60*(e-n),r=Math.round(a);if(n<10)var i="0"+n;else i=n;if(r<10)var s="0"+r;else s=r;return i+":"+s}},{key:"convertDateToDDMMMMYYYY",value:function(t){var e,n=t.split("-"),a=n[0],r=parseInt(n[1]),i=n[2];switch(r){case 1:e="January";break;case 2:e="February";break;case 3:e="March";break;case 4:e="April";break;case 5:e="May";break;case 6:e="June";break;case 7:e="July";break;case 8:e="August";break;case 9:e="September";break;case 10:e="October";break;case 11:e="November";break;case 12:e="December"}return i+". "+e+" "+a}},{key:"convertDateToDayNumber",value:function(t){var e=t.split("-"),n=parseInt(e[2]),a=parseInt(e[1]),r=parseInt(e[0]),i=new Date(r,a-1,n),s=new Date(i.getFullYear(),0,0);return Math.floor((i-s)/1e3/60/60/24)}},{key:"convertTimeToMinutes",value:function(t){var e=t.split(":");return 60*parseInt(e[0])+parseInt(e[1])}}]),t}(),pt=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;Object(c.a)(this,n),a=e.call(this,t);var r=new bt;return a.start_time=r.timeConvert(a.props.start_time),a.end_time=r.timeConvert(a.props.end_time),a.unique_id=a.props.unique_id,a.api=a.props.api,a}return Object(o.a)(n,[{key:"deleteClick",value:function(){var t=this;this.api.delete_activity(this.unique_id).then((function(){console.log("Deleted",t.props.activity_name),window.location.reload()})).catch((function(e){console.log("caught error",e),t.api.sendRefreshToken().then((function(){t.deleteClick()})).catch((function(){}))}))}},{key:"render",value:function(){var t=this;return Object(a.jsx)(dt.a,{className:"activity-card",children:Object(a.jsxs)(dt.a.Body,{children:[Object(a.jsxs)(dt.a.Title,{children:[Object(a.jsx)(jt,{category:this.props.activity_category,color:this.props.color,position_style:"absolute"}),this.start_time," - ",this.end_time,Object(a.jsx)(nt,{onClick:function(){return t.deleteClick()},position:"absolute"})]}),Object(a.jsx)(dt.a.Subtitle,{className:"activity-name",children:this.props.activity_name})]})})}}]),n}(r.Component),vt=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,t)}return Object(o.a)(n,[{key:"render",value:function(){return Object(a.jsxs)($.a,{className:"day",children:[Object(a.jsx)("thead",{children:Object(a.jsx)("th",{children:this.props.date})}),Object(a.jsx)("tbody",{children:this.createJSXItems(this.props.activities_for_day)})]})}},{key:"createJSXItems",value:function(t){t=rt(t,"minutes_after_midnight_start");var e,n=[],r=Object(ht.a)(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,s=i.activity_category,c=this.props.colorList[s];n.push(Object(a.jsxs)("tr",{children:[Object(a.jsx)(pt,{class:"activity",api:this.props.api,activity_name:i.activity_name,activity_category:s,color:c,start_time:i.minutes_after_midnight_start,end_time:i.minutes_after_midnight_end,unique_id:i.unique_id})," "]}))}}catch(o){r.e(o)}finally{r.f()}return n}}]),n}(r.Component),ft=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={loading:!0,backend_access_token:a.props.backendAccessToken,api_connection:a.props.api_connection,day_number_to_view:a.props.day_number_to_view,colorList:a.props.colorList,activities:rt(a.props.activities,"date")},a.dateHandler=new bt,a}return Object(o.a)(n,[{key:"CreateActivityObject",value:function(t){for(var e={},n=0;n<t.length;n++)t[n].date_string in e||(e[t[n].date_string]=[]),e[t[n].date_string].push(t[n]);return e}},{key:"renderDays",value:function(){var t=this.CreateActivityObject(this.state.activities),e=[];for(var n in t)e.push(Object(a.jsx)("th",{children:Object(a.jsx)(vt,{date:n,activities_for_day:t[n],colorList:this.state.colorList,api:this.props.api})}));return 0==e.length?Object(a.jsx)(st.a,{variant:"warning",children:"ALERT: No activities found for these days. To add an activity click the add button"}):e}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"table-div",children:Object(a.jsxs)($.a,{children:[" ",this.renderDays()," "]})})}}]),n}(r.Component),_t=n(192),gt=n(397),Ot=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={api_data:a.props.data,selected_value:null,title:a.props.title},a}return Object(o.a)(n,[{key:"componentDidUpdate",value:function(t){t.title!==this.props.title&&this.setState({title:this.props.title})}},{key:"createSelectItems",value:function(){var t=[];for(var e in this.state.api_data){var n=this.state.api_data[e].name,r=this.state.api_data[e].color;t.push(Object(a.jsxs)(_t.a.Item,{children:[Object(a.jsx)(tt,{color:r,size:"2vh"}),Object(a.jsx)("p",{className:"dropdown-text",children:n})]}))}return t}},{key:"render",value:function(){return""===this.state.title?Object(a.jsx)(gt.a,{style:{position:"relative",display:"inline-block"},title:"Category",onSelect:this.props.onSelect,children:this.createSelectItems()}):Object(a.jsx)(gt.a,{style:{position:"relative",display:"inline-block"},title:this.state.title,onSelect:this.props.onSelect,children:this.createSelectItems()})}}]),n}(r.Component),yt=n(405),kt=(r.Component,n(398)),mt=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a,r;return Object(c.a)(this,n),(a=e.call(this,t)).submitHandler=function(t){var e=a.dateHandler.convertDateToDDMMMMYYYY(a.state.activityDate),n=a.dateHandler.convertDateToDayNumber(a.state.activityDate),r=a.dateHandler.convertTimeToMinutes(a.state.activityStartTime),i=a.dateHandler.convertTimeToMinutes(a.state.activityEndTime);a.api_connection.post_activity(a.state.activityName,a.state.activityCategory,r,i,n,e).then((function(){a.GET_activities().then((function(){a.handleModalShowHide()}))})).catch((function(){a.api_connection.sendRefreshToken().then((function(){a.submitHandler()})).catch((function(){}))})),t.preventDefault()},a.state={activityName:"",activityCategory:"",activityDate:"",activityStartTime:"",activityEndTime:"",showHide:!1,loading_data_from_api:!0,backend_access_token:null,backend_refresh_token:null,server_error:!1,error_message:null,date_to_view:new Date,dayNumber_to_view:null,activities:null,colorList:{}},a.props.location.state?(localStorage.setItem("routeState",JSON.stringify(a.props.location.state)),r=a.props.location.state):(r=localStorage.getItem("routeState"))&&(r=JSON.parse(r)),a.state.backend_access_token=r.backend_access_token,a.state.backend_refresh_token=r.backend_refresh_token,a.submitHandler=a.submitHandler.bind(Object(U.a)(a)),a.api_connection=new y(a.state.backend_access_token,a.state.backend_refresh_token),localStorage.setItem("api",a.api_connection),a.dateHandler=new bt,a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.initGet()}},{key:"initGet",value:function(){var t=this;this.api_connection.get_current_date().then((function(e){t.currentdate=t.api_connection.date.date,t.currentDayNumber=t.api_connection.date.daynumber,t.setState({date_to_view:t.currentdate,dayNumber_to_view:t.currentDayNumber}),t.api_connection.get_categories().then((function(e){t.categories=t.api_connection.categories,t.setState({colorList:t.createColorList(t.categories)}),t.api_connection.get_activities(t.state.dayNumber_to_view,4).then((function(e){t.setState({activities:t.api_connection.activities,loading_data_from_api:!1})}))}))})).catch((function(){t.api_connection.sendRefreshToken().then((function(){t.initGet()})).catch((function(){t.setState({server_error:!0,error_message:t.api_connection.errorMessage})}))}))}},{key:"GET_date",value:function(){var t=this;this.api_connection.get_current_date().then((function(e){t.currentdate=t.api_connection.date.date,t.currentDayNumber=t.api_connection.date.daynumber,t.setState({date_to_view:t.currentdate,dayNumber_to_view:t.currentDayNumber})})).catch((function(){t.handleServerError(t.GET_date)}))}},{key:"GET_categories",value:function(){var t=Object(v.a)(p.a.mark((function t(){var e=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.api_connection.get_categories().then((function(t){return e.categories=e.api_connection.categories,e.setState({colorList:e.createColorList(e.categories)}),t}));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"GET_activities",value:function(){var t=Object(v.a)(p.a.mark((function t(){var e=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({loading_data_from_api:!0}),this.api_connection.get_activities(this.state.dayNumber_to_view,4).then((function(t){e.setState({activities:e.api_connection.activities,loading_data_from_api:!1})})).catch((function(){e.api_connection.sendRefreshToken().then((function(){e.GET_activities()})).catch((function(){console.log("Internal server error")}))}));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleServerError",value:function(){var t=Object(v.a)(p.a.mark((function t(e){var n=this;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.api_connection.sendRefreshToken().then((function(){e()})).catch((function(){n.setState({server_error:!0,error_message:n.api_connection.errorMessage})}));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"handleModalShowHide",value:function(){this.setState({showHide:!this.state.showHide,activityCategory:""})}},{key:"onDropdownSelect",value:function(t,e){this.setState({activityCategory:e.target.outerText})}},{key:"onDateChanged",value:function(t){this.state.date_to_view=t.target.value,this.state.dayNumber_to_view=this.dateHandler.convertDateToDayNumber(t.target.value),this.GET_activities()}},{key:"createColorList",value:function(t){var e={};for(var n in t)e[t[n].name]=t[n].color;return e}},{key:"render",value:function(){var t=this;return this.state.loading_data_from_api?this.state.server_error?"Unauthorized"===this.state.error_message?Object(a.jsx)("div",{children:Object(a.jsx)(g.c,{to:"/landing"})}):Object(a.jsxs)(st.a,{variant:"danger",children:["Server error: ",this.state.error_message]}):Object(a.jsx)(G,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Here are your activities for the next 4 days!"}),Object(a.jsx)(B,{value:this.state.date_to_view,label:"Date:",onChange:function(e){return t.onDateChanged(e)}}),Object(a.jsx)(ft,{api:this.api_connection,activities:this.state.activities,backendAccessToken:this.state.backend_access_token,day_number_to_view:this.state.dayNumber_to_view,colorList:this.state.colorList}),Object(a.jsx)(K,{handleClick:function(){return t.handleModalShowHide()}}),Object(a.jsxs)(ct.a,{show:this.state.showHide,centered:!0,children:[Object(a.jsx)(ct.a.Header,{closeButton:!0,onClick:function(){return t.handleModalShowHide()},children:Object(a.jsx)(ct.a.Title,{children:"Add activity"})}),Object(a.jsxs)(j.a,{children:[Object(a.jsxs)(ct.a.Body,{children:[Object(a.jsxs)(kt.a,{controlId:"formActivityName",children:[Object(a.jsx)(j.a.Label,{children:"Activity Name:"}),Object(a.jsx)(j.a.Control,{type:"string",placeholder:"Enter activity name...",style:{width:"fit-content",display:"inline-block"},onChange:function(e){return t.setState({activityName:e.target.value})}}),Object(a.jsx)(Ot,{data:this.categories,onSelect:function(e,n){return t.onDropdownSelect(e,n)},title:this.state.activityCategory})]}),Object(a.jsxs)(kt.a,{controlId:"formDate",children:[Object(a.jsx)(j.a.Label,{children:"Date:"}),Object(a.jsx)(j.a.Control,{type:"date",onChange:function(e){return t.setState({activityDate:e.target.value})}})]}),Object(a.jsxs)(kt.a,{controlId:"formStartTime",children:[Object(a.jsx)(j.a.Label,{children:"Start Time:"}),Object(a.jsx)(j.a.Control,{type:"time",onChange:function(e){return t.setState({activityStartTime:e.target.value})}})]}),Object(a.jsxs)(kt.a,{controlId:"formEndTime",children:[Object(a.jsx)(j.a.Label,{children:"End Time:"}),Object(a.jsx)(j.a.Control,{type:"time",onChange:function(e){return t.setState({activityEndTime:e.target.value})}})]})]}),Object(a.jsxs)(ct.a.Footer,{children:[Object(a.jsx)(_.a,{variant:"secondary",onClick:function(){return t.handleModalShowHide()},children:"Close"}),Object(a.jsx)(_.a,{variant:"primary",type:"submit",onClick:this.submitHandler,children:"Add Activity"})]})]})]})]})}}]),n}(r.Component),xt=Object(g.o)(mt);function Ct(){return Object(a.jsx)(T.HashRouter,{children:Object(a.jsxs)(g.g,{children:[Object(a.jsx)(g.d,{exact:!0,path:"/landing",children:Object(a.jsx)(A,{})}),Object(a.jsx)(g.d,{exact:!0,path:"/",children:Object(a.jsx)(A,{})}),Object(a.jsxs)(g.d,{exact:!0,path:"/activities",children:[Object(a.jsx)(S,{}),Object(a.jsx)("div",{className:"page-container",children:Object(a.jsx)(xt,{})})]}),Object(a.jsxs)(g.d,{exact:!0,path:"/categories",children:[Object(a.jsx)(S,{}),Object(a.jsx)("div",{className:"page-container",children:Object(a.jsx)(ut,{})})]}),Object(a.jsxs)(g.d,{exact:!0,path:"/stats",children:[Object(a.jsx)(S,{}),Object(a.jsx)("div",{className:"page-container",children:Object(a.jsx)(J,{})})]}),Object(a.jsxs)(g.d,{exact:!0,path:"/settings",children:[Object(a.jsx)(S,{}),Object(a.jsx)("div",{className:"page-container",children:Object(a.jsx)(Y,{})})]})]})})}var wt=function(){return Object(a.jsx)("div",{children:Object(a.jsx)(Ct,{})})},St=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,408)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,s=e.getTTFB;n(t),a(t),r(t),i(t),s(t)}))};s.a.render(Object(a.jsx)(T.BrowserRouter,{children:Object(a.jsx)(wt,{})}),document.getElementById("root")),St()},88:function(t,e,n){},98:function(t,e,n){}},[[354,1,2]]]);
//# sourceMappingURL=main.86767e0b.chunk.js.map